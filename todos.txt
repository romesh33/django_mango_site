-Когда обновляешь чатик и посылаешь сообщение - открывается адрес "http://127.0.0.1:8000/mess/threads/1/?csrfmiddlewaretoken=Cs41BswzLRhC6lWip7iJvbnrMpS3SmhfjfK1z6EQe6gaXlkVyDFXouZsQZPyTTWd&text=%D0%BE%D0%B9",
сообщение не посылается. Причем если переоткрыть адрес, а не обновляться - то все хорошо.
(черти что - попробовал еще несколько раз и вдруг все заработало и в IE, и в Firefox. Хотя до этого перегружал комп - и ничего. А сейчас помогло)
- Скрытие сообщения "Здесь будут сообщения" при пустом чате и отправке первого сообщения на страничке события - не работает в Firefox
- Обрабатывать случай, когда Anonymous хочет подключиться к сокету и послать сообщение в мультичат
- Страничка не открывается - http://127.0.0.1:8000/mess/threads/ (DoesNotExist at /mess/threads/, Message matching query does not exist.)

Install redis:
pip install asgi_redis

Проблема в чате со списком пользователей:
В тот момент, когда вызывается view для отрисовки чата, пользователь еще не подключен к сокету, а следовательно, его еще нет в списке.
Значит, нужно периодически запускать функцию для обновления списка пользователей.

26.10: Еще одна проблема: почему-то при дисконнекте сообщение в веб сокет посылается в consumers, но не доходит до сокета.
В итоге сокет не знает, что юзер отключился.

10.11: Когда анонимус пытается послать сообщение в чат - показывается ошибка в логах. Но на экране ничего не происходит. Сделать обработку ошибок.

ЧАТ
Функциональность должна быть такой:

- При заходе на страничку события юзер сразу попадает в чат, если он есть в списке участников

- В верхней части чата есть иконка с числом участников, уже подключившихся к чату

- Если кликнуть по иконке - появляется список пользователей в чате

- Если нажать на пользователе - можно отправить личное сообщение (перейти в личный чат) или открыть страничку с его профилем

- ‎Чат работает в режиме реального времени. Для браузеров, которые не поддерживают веб сокеты, можно добавить возможность обновления чата по таймауту

- Возле каждого нового сообщения показывается иконка пользователя, время

- Есть возможность прикрепить файл к сообщению - он отображается в режиме превью, если это картинка, и просто как приложение, если это не картинка

- Есть возможность использовать расширенную разметку, какую конкретно, не так важно

- Есть возможность отвечать на сообщения. При этом в чате показывается, к какому сообщению относится ответ (можно как в скайпе, с цитированием сообщения, или просто с ссылкой на сообщение)

- Наверху чата показывается текущая тема обсуждения, её может задать модератор. Например, подготовка к тестированию и обсуждение задачи, тестирование, и тд.

- Пользователи, которые не являются участниками, могут только читать чат. Но у них есть возможность вести обсуждение в комментариях (или в отдельном чате для наблюдателей?)

- Если обновить страницу, показываются только Н  сообщений. Если их больше - есть кнопочка "показать больше" или просто при прокрутке вверх более ранние сообщения начинают прогружаться.

- После окончания чата историю можно скачать в pdf или другом формате




Реализация:

- ‎Нужно добавить клиентский java script на страничку события - чтобы этот скрипт создавала веб сокет с уникальным путем для этого события, а также обновлял чат при получении нового сообщения в веб сокете.

- Нужно в обработчике (consumer) на стороне джанго сделать функции для обработки коннектов, дисконнектов, а также ‎простых сообщений.

- Для коннектов:

- дисконнектов:

- новых сообщений:


- как делать посылку сообщений по enter/ctrl+enter?
- deleting messages - in progress. Видимо мне все-таки придется переделать массив сообщений в массив ключей - значений.
Так будет легче удалять сообщения и редактировать.